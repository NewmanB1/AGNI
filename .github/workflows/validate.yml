name: OLS Validator

on: [push, pull_request]

jobs:
  validate_lessons:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Code
        uses: actions/checkout@v3

      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '18'

      - name: Install Validator Tools
        run: npm install -g ajv-cli js-yaml-cli

      - name: Validate 'Gravity' Lesson
        run: |
          # 1. Convert YAML to JSON (because schemas read JSON)
          # 2. Pipe it into the AJV Validator
          # 3. Check it against ols.schema.json
          js-yaml lessons/gravity.yaml --json | ajv validate --spec=draft7 -s schemas/ols.schema.json -d -

